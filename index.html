<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NOOR ‚Äì CandleCraft</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --bg:#f7f4ef;
  --card:#ffffff;
  --accent:#6b4f3f;
  --soft:#e6d8cf;
  --text:#2e2e2e;
}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui,sans-serif;background:var(--bg);color:var(--text);}
.container{max-width:1100px;margin:auto;padding:30px}
header h1{margin:0;color:var(--accent)}
header p{opacity:.7}
.card{background:var(--card);border-radius:14px;padding:20px;margin-bottom:30px;box-shadow:0 8px 24px rgba(0,0,0,.06);}
h2{margin-top:0;color:var(--accent)}
table{width:100%;border-collapse:collapse}
th,td{padding:10px;border-bottom:1px solid #eee;text-align:left}
th{background:var(--soft)}
input{width:80px;padding:6px;border-radius:6px;border:1px solid #ccc}
button{background:var(--accent);color:#fff;border:none;padding:8px 14px;border-radius:8px;cursor:pointer;font-weight:600;margin-top:5px}
.badge{padding:4px 10px;border-radius:999px;font-size:12px}
.ready{background:#d4edda;color:#155724}
.cure{background:#fff3cd;color:#856404}
#aiChat{max-height:250px;overflow-y:auto;border:1px solid #ccc;padding:10px;border-radius:8px;margin-top:10px;background:#fafafa;}
.aiInput{width:80%;padding:6px;border-radius:6px;border:1px solid #ccc;margin-top:5px;}
footer{text-align:center;opacity:.6;margin-top:60px}
</style>
</head>

<body>
<div class="container">

<header>
  <h1>NOOR ‚Äì CandleCraft</h1>
  <p>Recipes ¬∑ Inventory ¬∑ Cost ¬∑ Production ¬∑ AI Helper</p>
</header>

<!-- INVENTORY -->
<div class="card">
<h2>üì¶ Inventory</h2>
<table>
<tr><th>Item</th><th>Stock</th></tr>
<tr><td>Wax (g)</td><td><input id="invWax"></td></tr>
<tr><td>Fragrance (g)</td><td><input id="invFrag"></td></tr>
<tr><td>Wicks</td><td><input id="invWick"></td></tr>
<tr><td>Jars</td><td><input id="invJar"></td></tr>
</table>
<button onclick="recalcInventory()">üîÑ Recalc Inventory</button>
</div>

<!-- RECIPES -->
<div class="card">
<h2>üß™ Recipes</h2>
<table id="recipes">
<tr>
<th>Name</th><th>Wax</th><th>Frag</th><th>Wick</th>
<th>Cost</th><th>Price</th>
</tr>
<tr>
<td><input value="Vanilla Bliss"></td>
<td><input class="wax" value="50" oninput="calc()"></td>
<td><input class="frag" value="5" oninput="calc()"></td>
<td><input class="wick" value="1" oninput="calc()"></td>
<td class="cost">‚Äì</td>
<td class="price">‚Äì</td>
</tr>
</table>
<button onclick="addRecipe()">+ Add recipe</button>
</div>

<!-- CALENDAR -->
<div class="card">
<h2>üìÖ Production Calendar</h2>
<table id="calendar">
<tr><th>Recipe</th><th>Qty</th><th>Pour</th><th>Ready</th><th>Status</th></tr>
<tr>
<td><input value="Vanilla Bliss" class="recipeName"></td>
<td><input class="qty" value="10" oninput="recalcInventory()"></td>
<td><input type="date" class="pour" onchange="updateCalendar()"></td>
<td class="readyDate">‚Äì</td>
<td class="status">‚Äì</td>
</tr>
</table>
</div>

<!-- AI HELPER -->
<div class="card">
<h2>ü§ñ AI Helper</h2>
<div id="aiChat"></div>
<input class="aiInput" id="aiInput" placeholder="Ask AI..." />
<button onclick="askAI()">Ask AI</button>
</div>

<footer>¬© 2026 NOOR CandleCraft</footer>

</div>

<script>
// COSTS
const COSTS={wax:0.05,frag:0.10,wick:0.50,jar:0.80};
let initStock={wax:0,frag:0,wick:0,jar:0};

// SAVE / LOAD
function saveData(){
  const data={
    inventory:{
      wax:+document.getElementById('invWax').value||0,
      frag:+document.getElementById('invFrag').value||0,
      wick:+document.getElementById('invWick').value||0,
      jar:+document.getElementById('invJar').value||0
    },
    recipes:[],
    calendar:[]
  };
  document.querySelectorAll("#recipes tr").forEach((r,i)=>{
    if(i===0) return;
    data.recipes.push({
      name:r.querySelector("td:nth-child(1) input").value,
      wax:+r.querySelector(".wax").value||0,
      frag:+r.querySelector(".frag").value||0,
      wick:+r.querySelector(".wick").value||0
    });
  });
  document.querySelectorAll("#calendar tr").forEach((r,i)=>{
    if(i===0) return;
    data.calendar.push({
      name:r.querySelector(".recipeName").value,
      qty:+r.querySelector(".qty").value||0,
      pour:r.querySelector(".pour").value
    });
  });
  localStorage.setItem("noorData",JSON.stringify(data));
}

function loadData(){
  const d=localStorage.getItem("noorData");
  if(!d) return;
  const data=JSON.parse(d);
  // inventory
  document.getElementById('invWax').value=data.inventory.wax;
  document.getElementById('invFrag').value=data.inventory.frag;
  document.getElementById('invWick').value=data.inventory.wick;
  document.getElementById('invJar').value=data.inventory.jar;
  initStock={...data.inventory};
  // recipes
  const recipeTable=document.getElementById("recipes");
  while(recipeTable.rows.length>1) recipeTable.deleteRow(1);
  data.recipes.forEach(r=>{
    const row=recipeTable.insertRow();
    row.innerHTML=`<td><input value="${r.name}"></td>
<td><input class="wax" value="${r.wax}" oninput="calc()"></td>
<td><input class="frag" value="${r.frag}" oninput="calc()"></td>
<td><input class="wick" value="${r.wick}" oninput="calc()"></td>
<td class="cost">‚Äì</td>
<td class="price">‚Äì</td>`;
  });
  // calendar
  const calTable=document.getElementById("calendar");
  while(calTable.rows.length>1) calTable.deleteRow(1);
  data.calendar.forEach(c=>{
    const row=calTable.insertRow();
    row.innerHTML=`<td><input class="recipeName" value="${c.name}"></td>
<td><input class="qty" value="${c.qty}" oninput="recalcInventory()"></td>
<td><input type="date" class="pour" value="${c.pour}" onchange="updateCalendar()"></td>
<td class="readyDate">‚Äì</td>
<td class="status">‚Äì</td>`;
  });
}
loadData();

// CALC COST
function calc(){
  document.querySelectorAll("#recipes tr").forEach((r,i)=>{
    if(i===0) return;
    const wax=+r.querySelector(".wax").value||0;
    const frag=+r.querySelector(".frag").value||0;
    const wick=+r.querySelector(".wick").value||0;
    const cost=wax*COSTS.wax + frag*COSTS.frag + wick*COSTS.wick + COSTS.jar;
    r.querySelector(".cost").innerText=cost.toFixed(2);
    r.querySelector(".price").innerText=(cost*2.5).toFixed(2);
  });
  saveData();
}

// ADD RECIPE
function addRecipe(){
  const t=document.getElementById("recipes");
  const row=t.insertRow();
  row.innerHTML=`<td><input></td>
<td><input class="wax" oninput="calc()"></td>
<td><input class="frag" oninput="calc()"></td>
<td><input class="wick" oninput="calc()"></td>
<td class="cost">‚Äì</td>
<td class="price">‚Äì</td>`;
  saveData();
}

// CALENDAR
function updateCalendar(){
  const today=new Date();
  document.querySelectorAll("#calendar tr").forEach((r,i)=>{
    if(i===0) return;
    const pour=r.querySelector(".pour").value;
    if(!pour) return;
    const d=new Date(pour);
    const ready=new Date(d);
    ready.setDate(d.getDate()+7);
    r.querySelector(".readyDate").innerText=d.toISOString().split('T')[0];
    r.querySelector(".status").innerHTML=today>=ready?'<span class="badge ready">Ready</span>':'<span class="badge cure">In Cure</span>';
  });
  recalcInventory();
  saveData();
}

// INVENTORY
function recalcInventory(){
  let waxStock=initStock.wax;
  let fragStock=initStock.frag;
  let wickStock=initStock.wick;
  let jarStock=initStock.jar;

  document.querySelectorAll("#calendar tr").forEach((r,i)=>{
    if(i===0) return;
    const qty=+r.querySelector(".qty").value||0;
    const recipeName=r.querySelector(".recipeName").value;
    const recipeRow=Array.from(document.querySelectorAll("#recipes tr")).find((tr,j)=>j>0 && tr.querySelector("td input").value===recipeName);
    if(!recipeRow) return;
    const wax=+recipeRow.querySelector(".wax").value||0;
    const frag=+recipeRow.querySelector(".frag").value||0;
    const wick=+recipeRow.querySelector(".wick").value||0;

    waxStock=Math.max(0,waxStock - wax*qty);
    fragStock=Math.max(0,fragStock - frag*qty);
    wickStock=Math.max(0,wickStock - wick*qty);
    jarStock=Math.max(0,jarStock - qty);
  });

  document.getElementById('invWax').value=waxStock;
  document.getElementById('invFrag').value=fragStock;
  document.getElementById('invWick').value=wickStock;
  document.getElementById('invJar').value=jarStock;

  saveData();
}

// AI HELPER (MOCK)
function askAI(){
  const input=document.getElementById('aiInput').value.trim();
  if(!input) return;
  const chat=document.getElementById('aiChat');
  const userMsg=`<div><b>You:</b> ${input}</div>`;
  chat.innerHTML+=userMsg;

  // MOCK RESPONSE
  let response="ü§ñ Sorry, I need more data!";
  if(/price/i.test(input)){
    response="üí∞ Suggested price = Cost * 2.5 (default)";
  } else if(/wax/i.test(input)){
    response="üß¥ You can increase wax by 10% for stronger scent.";
  } else if(/inventory|stock/i.test(input)){
    response="üì¶ Check inventory above; recalc if needed.";
  } else if(/recipe/i.test(input)){
    response="üìù Try adjusting fragrance for better aroma balance.";
  }
  chat.innerHTML+=`<div><b>AI:</b> ${response}</div>`;
  chat.scrollTop=chat.scrollHeight;
  document.getElementById('aiInput').value="";
}

// INITIAL
calc();
updateCalendar();
recalcInventory();
</script>

</body>
</html>

